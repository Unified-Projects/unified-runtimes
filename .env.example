# URT Executor Configuration
# Copy this file to .env and adjust values as needed
#
# BACKWARDS COMPATIBILITY:
# All URT_* variables have OPR_EXECUTOR_* fallbacks for drop-in compatibility
# with existing OpenRuntimes deployments. URT_* takes priority when both are set.

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Host and port to bind
URT_HOST=0.0.0.0
URT_PORT=80

# =============================================================================
# AUTHENTICATION (Required for production)
# =============================================================================

# API secret key for Bearer token authentication
# REQUIRED: Set a strong secret in production
# Fallback: OPR_EXECUTOR_SECRET
URT_SECRET=your-secret-key-here

# =============================================================================
# RESOURCE OVERRIDES
# =============================================================================

# Minimum CPU allocation for any runtime (overrides lower requests)
# Set to 0 to disable override
# Fallback: OPR_EXECUTOR_MIN_CPUS
URT_MIN_CPUS=0

# Minimum memory in MB for any runtime (overrides lower requests)
# Set to 0 to disable override
# Fallback: OPR_EXECUTOR_MIN_MEMORY
URT_MIN_MEMORY=0

# =============================================================================
# REQUEST LIMITS
# =============================================================================

# Maximum request body size for executions
# Supports: bytes (20971520), KB (20480KB), MB (20MB), GB (1GB)
# Default: 20MB
# Fallback: OPR_EXECUTOR_MAX_BODY_SIZE
URT_MAX_BODY_SIZE=20MB

# =============================================================================
# LIFECYCLE CONFIGURATION
# =============================================================================

# Keep-alive mode: when true, containers never idle-timeout
# Only removed via DELETE endpoint or shutdown
# Default: true
# Fallback: OPR_EXECUTOR_KEEP_ALIVE
URT_KEEP_ALIVE=true

# Seconds before marking runtime as inactive (only used if URT_KEEP_ALIVE=false)
# Fallback: OPR_EXECUTOR_INACTIVE_THRESHOLD
URT_INACTIVE_THRESHOLD=60

# Seconds between maintenance cleanup tasks
# Fallback: OPR_EXECUTOR_MAINTENANCE_INTERVAL
URT_MAINTENANCE_INTERVAL=3600

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================

# Docker network name(s) for runtime containers (comma-separated)
# Fallback: OPR_EXECUTOR_NETWORK
URT_NETWORK=executor_runtimes

# Enable/disable auto-pulling images on startup
# Set to "disabled" to skip image pulls
# Fallback: OPR_EXECUTOR_IMAGE_PULL
URT_IMAGE_PULL=enabled

# Comma-separated list of allowed runtime images
# Leave empty to allow all images
# Fallback: OPR_EXECUTOR_RUNTIMES
URT_RUNTIMES=

# Supported runtime versions (comma-separated)
# Fallback: OPR_EXECUTOR_RUNTIME_VERSIONS
URT_RUNTIME_VERSIONS=v5

# Docker Hub credentials for private images
# Leave empty for public images only
# Fallback: OPR_EXECUTOR_DOCKER_HUB_USERNAME, OPR_EXECUTOR_DOCKER_HUB_PASSWORD
URT_DOCKER_HUB_USERNAME=
URT_DOCKER_HUB_PASSWORD=

# =============================================================================
# STORAGE CONFIGURATION
# =============================================================================

# Storage DSN for build artifacts
# Local: local://localhost
# S3/MinIO: s3://access_key:secret_key@host:port/bucket?region=us-east-1
# Fallback: OPR_EXECUTOR_CONNECTION_STORAGE
URT_CONNECTION_STORAGE=local://localhost

# =============================================================================
# RETRY CONFIGURATION
# =============================================================================

# Number of retry attempts for failed operations
# Fallback: OPR_EXECUTOR_RETRY_ATTEMPTS
URT_RETRY_ATTEMPTS=5

# Milliseconds to wait between retry attempts
# Fallback: OPR_EXECUTOR_RETRY_DELAY_MS
URT_RETRY_DELAY_MS=500

# =============================================================================
# LOGGING
# =============================================================================

# Log level: trace, debug, info, warn, error
RUST_LOG=info
